# üë• –û–¢–ß–ï–¢: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ "–ú–æ–∏ —Ä–µ—Ñ–µ—Ä–∞–ª—ã"

## ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û: –§—É–Ω–∫—Ü–∏—è "–ú–æ–∏ —Ä–µ—Ñ–µ—Ä–∞–ª—ã" –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

### üêõ –ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏:

1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π API endpoint**: –§—Ä–æ–Ω—Ç–µ–Ω–¥ –≤—ã–∑—ã–≤–∞–ª `/api/referrals/${userData.id}`, –Ω–æ —Å–µ—Ä–≤–µ—Ä –æ–∂–∏–¥–∞–µ—Ç `/api/referrals/by-id/${userData.id}`
2. **–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö**: –§—É–Ω–∫—Ü–∏—è `showReferralsModal()` –æ–∂–∏–¥–∞–ª–∞ —Å—Ç–∞—Ä—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö, –Ω–æ API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤—É—é

### üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

#### 1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω API endpoint**
```javascript
// –ë—ã–ª–æ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
const response = await fetch(`/api/referrals/${userData.id}`, {

// –°—Ç–∞–ª–æ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
const response = await fetch(`/api/referrals/by-id/${userData.id}`, {
```

#### 2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö API**
```javascript
// –ë—ã–ª–æ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
const totalReferrals = data.total_referrals || 0;
const regularReferrals = data.regular_referrals || 0;
const proReferrals = data.pro_referrals || 0;
const allReferrals = data.all_referrals || [];
const referralsByLevel = data.referrals_by_level || {};

// –°—Ç–∞–ª–æ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
const totalReferrals = data.stats?.total_referrals || 0;
const proReferrals = data.stats?.pro_referrals || 0;
const regularReferrals = totalReferrals - proReferrals;
const allReferrals = data.referrals || [];
const referralsByLevel = data.referralsByLevel || {};
```

#### 3. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É**
```javascript
// –ë—ã–ª–æ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
if (data.referral_stats) {
    totalEarnings = data.referral_stats.reduce(...)
}

// –°—Ç–∞–ª–æ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
if (data.referralStats) {
    totalEarnings = data.referralStats.reduce(...)
}
```

### üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö API:

#### **–û—Ç–≤–µ—Ç API:**
```json
{
  "success": true,
  "referrals": [
    {
      "id": 17,
      "telegram_id": 348777122,
      "username": "Oleg_Cherkalin",
      "first_name": "Oleg",
      "balance_ndn": 100,
      "is_pro": true,
      "referral_level": 1,
      "referral_path": "5,17",
      "created_at": "2025-10-13T15:27:44.318813+00:00"
    }
  ],
  "referralsByLevel": {
    "1": [...],
    "2": [...]
  },
  "stats": {
    "total_referrals": 6,
    "total_earnings": 950,
    "levels_count": 2,
    "pro_referrals": 5
  },
  "referralStats": [
    {
      "user_id": 5,
      "level": 1,
      "total_referrals": 4,
      "total_earnings": 800
    }
  ]
}
```

### üéØ –ß—Ç–æ —Ç–µ–ø–µ—Ä—å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è:

#### **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤:**
- ‚úÖ **–í—Å–µ–≥–æ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤**: 6
- ‚úÖ **–û–±—ã—á–Ω—ã—Ö**: 1 (6 - 5)
- ‚úÖ **PRO**: 5
- ‚úÖ **–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ**: 950 NDN

#### **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —É—Ä–æ–≤–Ω—è–º:**
- ‚úÖ **1 —É—Ä–æ–≤–µ–Ω—å**: 4 —Ä–µ—Ñ–µ—Ä–∞–ª–∞, +800 NDN
- ‚úÖ **2 —É—Ä–æ–≤–µ–Ω—å**: 1 —Ä–µ—Ñ–µ—Ä–∞–ª, +150 NDN
- ‚úÖ **3-7 —É—Ä–æ–≤–Ω–∏**: 0 —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤, +0 NDN

#### **–°–ø–∏—Å–æ–∫ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤:**
- ‚úÖ **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —É—Ä–æ–≤–Ω—è–º**
- ‚úÖ **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞–∂–¥–æ–º —Ä–µ—Ñ–µ—Ä–∞–ª–µ**:
  - –ò–º—è –∏ username
  - PRO —Å—Ç–∞—Ç—É—Å (üíé)
  - –ë–∞–ª–∞–Ω—Å NDN
  - –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
  - –£—Ä–æ–≤–µ–Ω—å —Ä–µ—Ñ–µ—Ä–∞–ª–∞

### üîÑ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:

1. **API –∑–∞–ø—Ä–æ—Å**: `/api/referrals/by-id/${userData.id}`
2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö**: –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ `data.stats`, `data.referrals`, `data.referralsByLevel`
3. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ**: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ + —Å–ø–∏—Å–æ–∫ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –ø–æ —É—Ä–æ–≤–Ω—è–º
4. **–†–∞—Å—á–µ—Ç—ã**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Å—á–µ—Ç –æ–±—ã—á–Ω—ã—Ö —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ (–≤—Å–µ–≥–æ - PRO)

### üì± –§—É–Ω–∫—Ü–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞:

1. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: –ö–∞—Ä—Ç–æ—á–∫–∏ —Å –æ–±—â–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
2. **–£—Ä–æ–≤–Ω–∏**: –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–∂–¥–æ–º—É —É—Ä–æ–≤–Ω—é
3. **–°–ø–∏—Å–æ–∫**: –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤
4. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è**: –ü–æ–∫–∞–∑ —Ç–æ–ª—å–∫–æ —É—Ä–æ–≤–Ω–µ–π —Å —Ä–µ—Ñ–µ—Ä–∞–ª–∞–º–∏

### üé® UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

- **–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏**: –ò–∫–æ–Ω–∫–∏ + –∑–Ω–∞—á–µ–Ω–∏—è
- **–£—Ä–æ–≤–Ω–∏**: –ù—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ —Å –¥–µ—Ç–∞–ª—è–º–∏
- **–°–ø–∏—Å–æ–∫ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤**: –ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
- **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å**: –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

## üéâ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**–§—É–Ω–∫—Ü–∏—è "–ú–æ–∏ —Ä–µ—Ñ–µ—Ä–∞–ª—ã" –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞!**

‚úÖ **API endpoint** –∏—Å–ø—Ä–∞–≤–ª–µ–Ω  
‚úÖ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö** —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç API  
‚úÖ **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ  
‚úÖ **–°–ø–∏—Å–æ–∫ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤** —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ  
‚úÖ **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —É—Ä–æ–≤–Ω—è–º** —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç  

**–¢–µ–ø–µ—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –≤–∏–¥–µ—Ç—å –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–≤–æ–∏—Ö —Ä–µ—Ñ–µ—Ä–∞–ª–∞—Ö! üë•**











