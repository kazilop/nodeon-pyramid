# NodeOn Pyramid - Telegram Mini App

–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –∏–≥—Ä–∞ —Å –º–æ–Ω–µ—Ç–∞–º–∏ NDN –¥–ª—è Telegram. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–∫—É–ø–∞—é—Ç Pro —Å—Ç–∞—Ç—É—Å –∑–∞ 1000 NDN –∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç —Å —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –¥–æ 7 —É—Ä–æ–≤–Ω–µ–π –≤ –≥–ª—É–±–∏–Ω—É.

## üöÄ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **Telegram Mini App** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞** - 7 —É—Ä–æ–≤–Ω–µ–π —Å –Ω–∞–≥—Ä–∞–¥–∞–º–∏
- **Telegram Stars** - –ø–æ–∫—É–ø–∫–∞ –∏ –≤—ã–≤–æ–¥ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –ø–ª–∞—Ç–µ–∂–Ω—É—é —Å–∏—Å—Ç–µ–º—É
- **Docker** - –ø—Ä–æ—Å—Ç–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
- **FastAPI** - –±—ã—Å—Ç—Ä—ã–π –∏ –Ω–∞–¥–µ–∂–Ω—ã–π –±—ç–∫–µ–Ω–¥
- **React** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥

## üìã –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îú‚îÄ‚îÄ backend/           # FastAPI –±—ç–∫–µ–Ω–¥
‚îÇ   ‚îú‚îÄ‚îÄ main.py       # –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ database.py   # –ú–æ–¥–µ–ª–∏ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ config.py     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ routers/      # API —Ä–æ—É—Ç–µ—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ telegram_bot.py # Telegram –±–æ—Ç
‚îú‚îÄ‚îÄ frontend/         # React —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ contexts/
‚îú‚îÄ‚îÄ docker-compose.yml
‚îî‚îÄ‚îÄ README.md
```

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone <repository-url>
cd nodeon-pyramid
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:

```bash
cp env.example .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env`:

```env
# Telegram Bot Configuration
TELEGRAM_BOT_TOKEN=your_bot_token_here
TELEGRAM_BOT_USERNAME=your_bot_username
TELEGRAM_WEBHOOK_URL=https://yourdomain.com/webhook

# Database
DATABASE_URL=postgresql://nodeon_user:nodeon_password@localhost:5432/nodeon_db

# Redis
REDIS_URL=redis://localhost:6379

# Security
SECRET_KEY=your_secret_key_here

# Developer Account
DEVELOPER_TELEGRAM_ID=your_telegram_id
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ Telegram –±–æ—Ç–∞

1. –ù–∞–π–¥–∏—Ç–µ [@BotFather](https://t.me/botfather) –≤ Telegram
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞: `/newbot`
3. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –∏ username
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Mini App: `/newapp`

### 4. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

```bash
docker-compose up -d
```

### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
curl -X POST "https://api.telegram.org/bot<YOUR_BOT_TOKEN>/setWebhook" \
     -H "Content-Type: application/json" \
     -d '{"url": "https://yourdomain.com/webhook"}'
```

## üéÆ –ö–∞–∫ –∏–≥—Ä–∞—Ç—å

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

1. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è**: –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ "–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"
2. **–ü–æ–∫—É–ø–∫–∞ NDN**: –ö—É–ø–∏—Ç–µ 1000 NDN –∑–∞ Telegram Stars
3. **Pro —Å—Ç–∞—Ç—É—Å**: –ü—Ä–∏–æ–±—Ä–µ—Ç–∏—Ç–µ Pro —Å—Ç–∞—Ç—É—Å –∑–∞ 1000 NDN
4. **–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞**: –ü–æ–ª—É—á–∏—Ç–µ —Å–≤–æ—é —É–Ω–∏–∫–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É
5. **–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –¥—Ä—É–∑–µ–π**: –î–µ–ª–∏—Ç–µ—Å—å —Å—Å—ã–ª–∫–æ–π –∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ
6. **–í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤**: –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π—Ç–µ NDN –æ–±—Ä–∞—Ç–Ω–æ –≤ Stars

### –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:

- **–£—Ä–æ–≤–µ–Ω—å 1**: 200 NDN –∑–∞ –∫–∞–∂–¥–æ–≥–æ Pro —Ä–µ—Ñ–µ—Ä–∞–ª–∞
- **–£—Ä–æ–≤–µ–Ω—å 2-7**: 150 NDN –∑–∞ –∫–∞–∂–¥–æ–≥–æ Pro —Ä–µ—Ñ–µ—Ä–∞–ª–∞
- **–ö–æ–º–∏—Å—Å–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞**: 200 NDN —Å –∫–∞–∂–¥–æ–π –ø–æ–∫—É–ø–∫–∏ Pro

## üìä API Endpoints

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `POST /api/auth/login` - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram
- `GET /api/auth/me` - –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- `POST /api/users/buy-pro` - –ü–æ–∫—É–ø–∫–∞ Pro —Å—Ç–∞—Ç—É—Å–∞
- `POST /api/users/withdraw` - –ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–≤–æ–¥ NDN
- `GET /api/users/balance/{user_id}` - –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞

### –ü–ª–∞—Ç–µ–∂–∏
- `POST /api/payments/buy-ndn` - –ü–æ–∫—É–ø–∫–∞ NDN –∑–∞ Stars
- `POST /api/payments/telegram-stars-webhook` - Webhook Telegram Stars
- `GET /api/payments/payment-methods` - –°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã

### –†–µ—Ñ–µ—Ä–∞–ª—ã
- `POST /api/referrals/join-by-referral` - –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ —Å—Å—ã–ª–∫–µ
- `GET /api/referrals/referral-stats/{user_id}` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤
- `GET /api/referrals/referral-tree/{user_id}` - –î–µ—Ä–µ–≤–æ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `GET /api/stats/dashboard/{user_id}` - –î–∞—à–±–æ—Ä–¥
- `GET /api/stats/transactions/{user_id}` - –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- `GET /api/stats/leaderboard` - –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤
- `GET /api/stats/game-rules` - –ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã

## üóÑ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:

- **users** - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- **transactions** - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- **referral_stats** - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤
- **payment_requests** - –ó–∞—è–≤–∫–∏ –Ω–∞ –≤—ã–≤–æ–¥

### –°—Ö–µ–º–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã:

```
User A (Pro) -> User B (Pro) -> User C (Pro) -> ...
    200 NDN        150 NDN        150 NDN
```

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:

```bash
# –ë—ç–∫–µ–Ω–¥
cd backend
pip install -r requirements.txt
uvicorn main:app --reload

# –§—Ä–æ–Ω—Ç–µ–Ω–¥
cd frontend
npm install
npm start

# –ë–æ—Ç
python telegram_bot.py
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
docker-compose -f docker-compose.test.yml up --build
```

## üì± Telegram WebApp SDK

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π Telegram WebApp SDK:

```javascript
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
window.Telegram.WebApp.ready();
window.Telegram.WebApp.expand();

// –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const user = window.Telegram.WebApp.initDataUnsafe.user;

// –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
window.Telegram.WebApp.close();
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ Telegram WebApp
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- –ó–∞—â–∏—Ç–∞ –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π —á–µ—Ä–µ–∑ SQLAlchemy
- Rate limiting –¥–ª—è API
- HTTPS –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫
- –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö

## üöÄ –î–µ–ø–ª–æ–π

### Production –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

1. –û–±–Ω–æ–≤–∏—Ç–µ `TELEGRAM_WEBHOOK_URL` –≤ `.env`
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ–º–µ–Ω –¥–ª—è Mini App
3. –í–∫–ª—é—á–∏—Ç–µ HTTPS
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
5. –°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –ë–î

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:

- –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Docker Swarm
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Redis
- CDN –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
- Load balancer –¥–ª—è API

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- **Telegram**: @your_support_bot
- **Email**: support@yourdomain.com
- **GitHub Issues**: [–°–æ–∑–¥–∞—Ç—å issue](https://github.com/your-repo/issues)

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. —Ñ–∞–π–ª [LICENSE](LICENSE)

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –°–æ–∑–¥–∞–π—Ç–µ feature branch
3. Commit –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. Push –≤ branch
5. –°–æ–∑–¥–∞–π—Ç–µ Pull Request

---

**NodeOn Pyramid** - –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ —Å —Ä–µ—Ñ–µ—Ä–∞–ª–∞–º–∏ –≤ Telegram! üöÄ
