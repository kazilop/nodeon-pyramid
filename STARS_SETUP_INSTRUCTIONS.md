# ‚≠ê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Stars –¥–ª—è NodeOn Pyramid

## üìã –ß—Ç–æ –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Telegram Stars –≤ —Ç–∞–±–ª–∏—Ü–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ –¥–ª—è Stars –ø–ª–∞—Ç–µ–∂–µ–π (`nodeon_stars_payments`)
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Stars (`nodeon_stars_config`)
- ‚úÖ –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ Stars –ø–ª–∞—Ç–µ–∂–µ–π
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Ü–µ–ø–æ—á–∫–∏

### 2. API Endpoints
- ‚úÖ `GET /api/stars/config` - –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Stars
- ‚úÖ `POST /api/stars/buy-ndn` - –ü–æ–∫—É–ø–∫–∞ NDN –∑–∞ Stars
- ‚úÖ `POST /api/stars/withdraw` - –í—ã–≤–æ–¥ NDN –≤ Stars
- ‚úÖ `GET /api/stats/referrals` - –î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### 3. Frontend
- ‚úÖ –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∏ –≤—ã–≤–æ–¥–∞ Stars
- ‚úÖ –ö—Ä–∞—Å–∏–≤—ã–π UI —Å –∞–Ω–∏–º–∞—Ü–∏—è–º–∏
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ª–∏–º–∏—Ç–æ–≤ –∏ —Ä–∞—Å—á–µ—Ç—ã
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram WebApp

## üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –®–∞–≥ 1: –û–±–Ω–æ–≤–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ Supabase SQL Editor:

```sql
-- –°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ ADD_STARS_SUPPORT.sql
-- –ó–∞—Ç–µ–º UPDATE_DATABASE_SCHEMA.sql
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:
- –ö—É—Ä—Å: 1 Star = 1 NDN
- –ú–∏–Ω–∏–º—É–º –ø–æ–∫—É–ø–∫–∏: 10 Stars
- –ú–∞–∫—Å–∏–º—É–º –ø–æ–∫—É–ø–∫–∏: 10,000 Stars
- –ö–æ–º–∏—Å—Å–∏—è –∑–∞ –≤—ã–≤–æ–¥: 5%

### –®–∞–≥ 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Telegram
2. –ù–∞–∂–º–∏—Ç–µ "–ö—É–ø–∏—Ç—å NDN –∑–∞ Stars"
3. –í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ Stars
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞—Å—á–µ—Ç NDN
5. –ù–∞–∂–º–∏—Ç–µ "–ö—É–ø–∏—Ç—å –∑–∞ Stars"

## üí´ –§—É–Ω–∫—Ü–∏–∏ Stars

### –ü–æ–∫—É–ø–∫–∞ NDN –∑–∞ Stars
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø–æ–∫—É–ø–∞—Ç—å NDN –∏—Å–ø–æ–ª—å–∑—É—è Telegram Stars
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –∫—É—Ä—Å–∞ –æ–±–º–µ–Ω–∞
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ª–∏–º–∏—Ç–æ–≤ –ø–æ–∫—É–ø–∫–∏
- –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –∑–∞—á–∏—Å–ª–µ–Ω–∏–µ NDN

### –í—ã–≤–æ–¥ NDN –≤ Stars
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è NDN –æ–±—Ä–∞—Ç–Ω–æ –≤ Telegram Stars
- –ö–æ–º–∏—Å—Å–∏—è –∑–∞ –≤—ã–≤–æ–¥ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç–∏ —Å—Ä–µ–¥—Å—Ç–≤
- –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

### –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ü–µ–ø–æ—á–∫–∏ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –¥–æ 7 —É—Ä–æ–≤–Ω–µ–π
- –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —É—Ä–æ–≤–Ω—è–º
- –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥–≤–æ–π–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Stars –º–æ–∂–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü–µ `nodeon_stars_config`:

```sql
-- –ò–∑–º–µ–Ω–∏—Ç—å –∫—É—Ä—Å –æ–±–º–µ–Ω–∞
UPDATE nodeon_stars_config 
SET config_value = '1.5' 
WHERE config_key = 'stars_to_ndn_rate';

-- –ò–∑–º–µ–Ω–∏—Ç—å –∫–æ–º–∏—Å—Å–∏—é –∑–∞ –≤—ã–≤–æ–¥
UPDATE nodeon_stars_config 
SET config_value = '3' 
WHERE config_key = 'stars_withdrawal_fee_percent';
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ Stars –ø–ª–∞—Ç–µ–∂–µ–π
```sql
SELECT 
    sp.*,
    u.first_name,
    u.username
FROM nodeon_stars_payments sp
JOIN nodeon_users u ON sp.user_id = u.id
ORDER BY sp.created_at DESC;
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ Stars
```sql
SELECT 
    COUNT(*) as total_payments,
    SUM(stars_amount) as total_stars,
    SUM(ndn_amount) as total_ndn,
    AVG(stars_amount) as avg_stars_per_payment
FROM nodeon_stars_payments
WHERE status = 'completed';
```

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–†–µ–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Stars API**
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook –¥–ª—è Stars –ø–ª–∞—Ç–µ–∂–µ–π
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Payments API
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö Stars —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

2. **–£–ª—É—á—à–µ–Ω–∏—è UI**
   - –ò—Å—Ç–æ—Ä–∏—è Stars —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
   - –ì—Ä–∞—Ñ–∏–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–ª–∞—Ç–µ–∂–∞—Ö

3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–µ–π Stars –ø–ª–∞—Ç–µ–∂–µ–π
   - –ó–∞—â–∏—Ç–∞ –æ—Ç –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞
   - –ê—É–¥–∏—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

## ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- üí∞ –ü–æ–∫—É–ø–∫—É NDN –∑–∞ Telegram Stars
- üí∏ –í—ã–≤–æ–¥ NDN –≤ Telegram Stars  
- üîó –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—É—é —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É
- üìä –î–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
- üé® –ö—Ä–∞—Å–∏–≤—ã–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π UI

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ª–µ–≥–∫–æ –ø–æ–∫—É–ø–∞—Ç—å –∏ –≤—ã–≤–æ–¥–∏—Ç—å NDN, –∞ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –∫–æ–º–∏—Å—Å–∏—é —Å –∫–∞–∂–¥–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏!
