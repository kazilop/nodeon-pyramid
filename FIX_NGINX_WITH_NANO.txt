ðŸ”§ Ð˜Ð¡ÐŸÐ ÐÐ’Ð›Ð•ÐÐ˜Ð• NGINX ÐšÐžÐÐ¤Ð˜Ð“Ð£Ð ÐÐ¦Ð˜Ð˜ Ð§Ð•Ð Ð•Ð— NANO
============================================

âŒ ÐŸÐ ÐžÐ‘Ð›Ð•ÐœÐ:
ÐžÑˆÐ¸Ð±ÐºÐ° 500 Internal Server Error Ð¸Ð·-Ð·Ð° Ð·Ð°Ñ†Ð¸ÐºÐ»Ð¸Ð²Ð°Ð½Ð¸Ñ Ñ€ÐµÐ´Ð¸Ñ€ÐµÐºÑ‚Ð° Ð² Nginx

âœ… Ð Ð•Ð¨Ð•ÐÐ˜Ð• Ð§Ð•Ð Ð•Ð— NANO:

1. ÐŸÐžÐ”ÐšÐ›Ð®Ð§Ð•ÐÐ˜Ð• Ðš Ð¡Ð•Ð Ð’Ð•Ð Ð£:
   ssh root@147.45.110.220

2. ÐžÐ¢ÐšÐ Ð«Ð¢Ð˜Ð• ÐšÐžÐÐ¤Ð˜Ð“Ð£Ð ÐÐ¦Ð˜Ð˜ Ð’ NANO:
   nano /etc/nginx/sites-available/nodeon

3. Ð—ÐÐœÐ•ÐÐ Ð¡ÐžÐ”Ð•Ð Ð–Ð˜ÐœÐžÐ“Ðž Ð¤ÐÐ™Ð›Ð:
   
   Ð£Ð”ÐÐ›Ð˜Ð¢Ð• Ð’Ð¡Ð• Ð¡ÐžÐ”Ð•Ð Ð–Ð˜ÐœÐžÐ• (Ctrl+K Ð´Ð»Ñ ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ ÑÑ‚Ñ€Ð¾Ðº)
   
   Ð’Ð¡Ð¢ÐÐ’Ð¬Ð¢Ð• ÐÐžÐ’Ð£Ð® ÐšÐžÐÐ¤Ð˜Ð“Ð£Ð ÐÐ¦Ð˜Ð®:
   
   server {
       listen 443 ssl;
       server_name sistemypro.ru www.sistemypro.ru;
       
       ssl_certificate /etc/letsencrypt/live/sistemypro.ru/fullchain.pem;
       ssl_certificate_key /etc/letsencrypt/live/sistemypro.ru/privkey.pem;
       include /etc/letsencrypt/options-ssl-nginx.conf;
       ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;
       
       root /root/nodeon/public;
       index index.html;
       
       # Serve static files directly
       location / {
           try_files $uri $uri/ @fallback;
       }
       
       # Fallback to index.html for SPA routing
       location @fallback {
           try_files /index.html =404;
       }
       
       # API routes - proxy to Node.js
       location /api/ {
           proxy_pass http://localhost:3000;
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_set_header X-Forwarded-Proto $scheme;
           proxy_set_header X-Forwarded-Host $host;
           proxy_set_header X-Forwarded-Port $server_port;
       }
       
       # Health check - proxy to Node.js
       location /health {
           proxy_pass http://localhost:3000;
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_set_header X-Forwarded-Proto $scheme;
       }
   }

   server {
       listen 80;
       server_name sistemypro.ru www.sistemypro.ru;
       return 301 https://$host$request_uri;
   }

4. Ð¡ÐžÐ¥Ð ÐÐÐ•ÐÐ˜Ð• Ð¤ÐÐ™Ð›Ð:
   Ctrl+O (Write Out)
   ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Enter Ð´Ð»Ñ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ñ

5. Ð’Ð«Ð¥ÐžÐ” Ð˜Ð— NANO:
   Ctrl+X

6. ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ ÐšÐžÐÐ¤Ð˜Ð“Ð£Ð ÐÐ¦Ð˜Ð˜:
   nginx -t

7. ÐŸÐ•Ð Ð•Ð—ÐÐŸÐ£Ð¡Ðš NGINX:
   systemctl restart nginx

8. ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ Ð¡Ð¢ÐÐ¢Ð£Ð¡Ð:
   systemctl status nginx

9. Ð¢Ð•Ð¡Ð¢Ð˜Ð ÐžÐ’ÐÐÐ˜Ð•:
   curl -I https://sistemypro.ru/
   curl -I https://sistemypro.ru/api/health

ðŸ”§ ÐšÐžÐœÐÐÐ”Ð« NANO:
- Ctrl+O - Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»
- Ctrl+X - Ð’Ñ‹Ð¹Ñ‚Ð¸ Ð¸Ð· nano
- Ctrl+K - Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ ÑÑ‚Ñ€Ð¾ÐºÑƒ
- Ctrl+U - Ð’ÑÑ‚Ð°Ð²Ð¸Ñ‚ÑŒ ÑÑ‚Ñ€Ð¾ÐºÑƒ
- Ctrl+W - ÐŸÐ¾Ð¸ÑÐº
- Ctrl+\ - Ð—Ð°Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ñ‚ÐµÐºÑÑ‚

ðŸš¨ ÐÐ›Ð¬Ð¢Ð•Ð ÐÐÐ¢Ð˜Ð’ÐÐ«Ð™ Ð¡ÐŸÐžÐ¡ÐžÐ‘ (ÐµÑÐ»Ð¸ nano Ð½Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚):

1. Ð¡ÐžÐ—Ð”ÐÐÐ˜Ð• Ð Ð•Ð—Ð•Ð Ð’ÐÐžÐ™ ÐšÐžÐŸÐ˜Ð˜:
   cp /etc/nginx/sites-available/nodeon /etc/nginx/sites-available/nodeon.backup

2. Ð¡ÐžÐ—Ð”ÐÐÐ˜Ð• ÐÐžÐ’ÐžÐ“Ðž Ð¤ÐÐ™Ð›Ð:
   cat > /etc/nginx/sites-available/nodeon << 'EOF'
   server {
       listen 443 ssl;
       server_name sistemypro.ru www.sistemypro.ru;
       
       ssl_certificate /etc/letsencrypt/live/sistemypro.ru/fullchain.pem;
       ssl_certificate_key /etc/letsencrypt/live/sistemypro.ru/privkey.pem;
       include /etc/letsencrypt/options-ssl-nginx.conf;
       ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;
       
       root /root/nodeon/public;
       index index.html;
       
       location / {
           try_files $uri $uri/ @fallback;
       }
       
       location @fallback {
           try_files /index.html =404;
       }
       
       location /api/ {
           proxy_pass http://localhost:3000;
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_set_header X-Forwarded-Proto $scheme;
       }
       
       location /health {
           proxy_pass http://localhost:3000;
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_set_header X-Forwarded-Proto $scheme;
       }
   }

   server {
       listen 80;
       server_name sistemypro.ru www.sistemypro.ru;
       return 301 https://$host$request_uri;
   }
   EOF

3. ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ Ð˜ ÐŸÐ•Ð Ð•Ð—ÐÐŸÐ£Ð¡Ðš:
   nginx -t
   systemctl restart nginx

âœ… Ð Ð•Ð—Ð£Ð›Ð¬Ð¢ÐÐ¢:
ÐŸÐ¾ÑÐ»Ðµ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ ÑÐ°Ð¹Ñ‚ https://sistemypro.ru Ð´Ð¾Ð»Ð¶ÐµÐ½ Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ Ð±ÐµÐ· Ð¾ÑˆÐ¸Ð±ÐºÐ¸ 500

ðŸ“ ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ:
- https://sistemypro.ru - Ð³Ð»Ð°Ð²Ð½Ð°Ñ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ð°
- https://sistemypro.ru/api/health - API health check

ðŸ” ÐžÐ¢Ð›ÐÐ”ÐšÐ:
Ð•ÑÐ»Ð¸ Ñ‡Ñ‚Ð¾-Ñ‚Ð¾ Ð½Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð»Ð¾Ð³Ð¸:
- tail -f /var/log/nginx/error.log
- pm2 logs nodeon-pyramid

