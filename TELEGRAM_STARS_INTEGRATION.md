# üîß –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø Telegram Stars API

## ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û: Telegram Stars API –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω

### üéØ –¶–µ–ª—å:

**–°–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã:**
1. ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç Stars —á–µ—Ä–µ–∑ Telegram
2. ‚úÖ Stars –ø–µ—Ä–µ–≤–æ–¥—è—Ç—Å—è –Ω–∞ —Å—á–µ—Ç –±–æ—Ç–∞
3. ‚úÖ –ë–æ—Ç –Ω–∞—á–∏—Å–ª—è–µ—Ç NDN –Ω–∞ —Å—á–µ—Ç –∏–≥—Ä–æ–∫–∞

## üîç –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø:

### **1. API endpoint (`/api/payments/create-invoice`):**

**–ò–∑–º–µ–Ω–µ–Ω–æ:**
```javascript
// –¢–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è Telegram Stars
res.json({
  success: true,
  invoice_link: invoice_link,
  transaction_id: transaction.id,
  amount_ndn: amount_ndn,
  amount_stars: amount_ndn,
  description: description,
  // –î–∞–Ω–Ω—ã–µ –¥–ª—è Telegram Stars
  stars_amount: amount_ndn,
  invoice_id: `invoice_${transaction.id}`
});
```

### **2. –§—Ä–æ–Ω—Ç–µ–Ω–¥ (`confirmBuyNDN`):**

**–ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞:**
```javascript
// –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å—á–µ—Ç —á–µ—Ä–µ–∑ Telegram Mini App Stars API
const telegram = window.Telegram?.WebApp;
if (telegram && telegram.openInvoice) {
    console.log('üîê –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å—á–µ—Ç —á–µ—Ä–µ–∑ Telegram Stars API...');
    
    telegram.openInvoice(result.invoice_link, (status) => {
        if (status === 'paid') {
            console.log('‚úÖ –ü–ª–∞—Ç–µ–∂ —É—Å–ø–µ—à–µ–Ω, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º...');
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            fetch('/api/payments/confirm-payment', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    transaction_id: result.transaction_id,
                    status: 'paid'
                })
            }).then(() => {
                showNotification('‚úÖ –ü–ª–∞—Ç–µ–∂ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω! NDN –∑–∞—á–∏—Å–ª–µ–Ω—ã –Ω–∞ –≤–∞—à —Å—á–µ—Ç.', 'success');
                loadUserData();
            });
        }
    });
}
```

### **3. –¶–µ–ø–æ—á–∫–∞ –æ–ø–ª–∞—Ç—ã:**

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–ö—É–ø–∏—Ç—å NDN –∑–∞ Stars"** ‚úÖ
2. **–°–æ–∑–¥–∞–µ—Ç—Å—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –≤ –ë–î** ‚úÖ
3. **–û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è Telegram Stars –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ–ø–ª–∞—Ç—ã** ‚úÖ
4. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç Stars** ‚úÖ
5. **Telegram –ø–µ—Ä–µ–¥–∞–µ—Ç Stars –Ω–∞ —Å—á–µ—Ç –±–æ—Ç–∞** ‚úÖ
6. **–°–µ—Ä–≤–µ—Ä –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –ø–ª–∞—Ç–µ–∂ —á–µ—Ä–µ–∑ `/api/payments/confirm-payment`** ‚úÖ
7. **NDN –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è –Ω–∞ —Å—á–µ—Ç –∏–≥—Ä–æ–∫–∞** ‚úÖ
8. **–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è** ‚úÖ

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï:

### **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**

1. ‚úÖ **API endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç** - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç invoice_link
2. ‚úÖ **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å–æ–∑–¥–∞–µ—Ç—Å—è** - –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –ë–î
3. ‚úÖ **Telegram API –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è** - openInvoice —Ä–∞–±–æ—Ç–∞–µ—Ç
4. ‚úÖ **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞** - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
5. ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞** - NDN –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è –∏–≥—Ä–æ–∫—É

## üìä –ò–¢–û–ì–ò:

### **–ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**

1. ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Telegram Stars API** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è openInvoice
2. ‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π** - –∑–∞–ø–∏—Å—å –≤ –ë–î
3. ‚úÖ **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤
4. ‚úÖ **–ù–∞—á–∏—Å–ª–µ–Ω–∏–µ NDN** - –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã
5. ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** - –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### **–¶–µ–ø–æ—á–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí Telegram Stars API ‚Üí –ë–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç Stars ‚Üí 
‚Üí NDN –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è –∏–≥—Ä–æ–∫—É ‚úÖ
```

## üéâ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï:

**Telegram Stars API –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω!**

‚úÖ **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç Stars** - —á–µ—Ä–µ–∑ Telegram  
‚úÖ **Stars –∏–¥—É—Ç –Ω–∞ —Å—á–µ—Ç –±–æ—Ç–∞** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏  
‚úÖ **NDN –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è –∏–≥—Ä–æ–∫—É** - –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã  
‚úÖ **–¶–µ–ø–æ—á–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç** - –æ—Ç –ø–æ–∫—É–ø–∫–∏ –¥–æ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è  

**–ü–æ–∫—É–ø–∫–∞ NDN –∑–∞ Stars –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÄ**












